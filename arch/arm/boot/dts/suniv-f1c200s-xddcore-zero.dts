// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright 2022 Icenowy Zheng <uwu@icenowy.me>
 * Modify by xddcore 2023
 */

/dts-v1/;
#include "suniv-f1c100s.dtsi"

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include <dt-bindings/leds/common.h>
#include <dt-bindings/interrupt-controller/irq.h>

/ {
	model = "Xddcore Zero Board";
	compatible = "xddcore,Zero Board","allwinner,suniv-f1c200s", 
				 "allwinner,suniv-f1c100s";

	aliases {
		serial0 = &uart0;
	};

	chosen {
		stdout-path = "serial0:115200n8";
	};

	leds {
		compatible = "gpio-leds";

		led {
			function = LED_FUNCTION_STATUS;
			color = <LED_COLOR_ID_BLUE>;
			gpios = <&pio 4 2 GPIO_ACTIVE_LOW>; /* PE2 */
			linux,default-trigger = "heartbeat";
		};
	};

	reg_vcc3v3: regulator-3v3 {
		compatible = "regulator-fixed";
		regulator-name = "vcc3v3";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
	};
};

&mmc0 {
	broken-cd;
	bus-width = <4>;
	disable-wp;
	vmmc-supply = <&reg_vcc3v3>;
	status = "okay";
};


&spi0 {
        pinctrl-names = "default";
        pinctrl-0 = <&spi0_pc_pins>;
        status = "okay";
};

&spi1 {
        pinctrl-names = "default";
        pinctrl-0 = <&spi1_pc_pins>;
        status = "okay";
		st7789v@0 {
			status = "okay";
			compatible = "sitronix,st7789v";
				reg = <0>;
				spi-max-frequency =<40000000>;        //SPI时钟40M,差不多是st7789v的极限，理论帧率32FPS
				rotate =<90>;                    //屏幕旋转90度
				spi-cpol;
				spi-cpha;
				rgb;                           //颜色格式RGB
				fps =<30>;                      //刷新30帧率
				buswidth =<8>;                   //总线宽度8
				reset-gpios =<&pio 3 7 GPIO_ACTIVE_LOW>;   //PD7
				led-gpios =<&pio 3 8 GPIO_ACTIVE_LOW>;   //PD8
				dc-gpios =<&pio 3 9 GPIO_ACTIVE_LOW>;   //PD9
				debug =<0>;                     //不开启调试
        };
};

&i2c0 {
        pinctrl-names = "default";
        pinctrl-0 = <&i2c0_pins>;
        status = "okay";

		/* Accelerometer/gyroscope */
		mpu6050@68 {
			compatible = "invensense,mpu6050";
			reg = <0x68>;
			interrupt-parent = <&pio>;
			interrupts = <4 3 IRQ_TYPE_EDGE_RISING>; /* PE3 */
			vdd-supply = <&reg_vcc3v3>;
			vddio-supply = <&reg_vcc3v3>;
			mount-matrix = "-0.984807753012208",  /* x0 */
		               	   "0",                   /* y0 */
		               	   "-0.173648177666930",  /* z0 */
		                   "0",                   /* x1 */
		                   "-1",                  /* y1 */
		                   "0",                   /* z1 */
		                   "-0.173648177666930",  /* x2 */
		                   "0",                   /* y2 */
		                   "0.984807753012208";   /* z2 */
		};
};

&i2c1{
        pinctrl-names = "default";
        pinctrl-0 = <&i2c1_pins>;
        status = "okay";
		gt911: touchscreen@5d {
			compatible = "goodix,gt911";
			reg = <0x5d>;
			interrupt-parent = <&pio>;
			interrupts = <3 3 IRQ_TYPE_EDGE_FALLING>; /* EINT3 (PD3) */
			irq-gpios = <&pio 3 3 GPIO_ACTIVE_HIGH>; /* INT (PD3) */
			reset-gpios = <&pio 3 4 GPIO_ACTIVE_HIGH>; /* RST (PD4) */
			touchscreen-swapped-x-y;
			touchscreen-inverted-y;
			};
};

&codec {
    allwinner,audio-routing =
    "Headphone", "HP",
    "Headphone", "HPCOM",
    "MIC", "Mic";
    status = "okay";
};

&uart0 {
	pinctrl-names = "default";
	pinctrl-0 = <&uart0_pe_pins>;
	status = "okay";
};

&otg_sram {
        status = "okay";
};

&usb_otg {
        dr_mode = "otg"; /* otg / host / peripheral */
        status = "okay";
};

&usbphy {
       /* usb0_id_det-gpio = <&pio 4 2 GPIO_ACTIVE_HIGH>; PE2 */
        status = "okay";
};
